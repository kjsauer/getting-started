# Getting Started with Solar Photovoltaics
Kenneth J. Sauer (@kjsauer on GitHub)

## Acronyms
_Ref: At reference conditions of global plane-of-array irradiance, cell temperature, and solar spectrum
devEtaRel_Ref: Deviation in PV cell or module efficiency relative to reference test conditions (e.g., STC)
DAQ: Often used synonymously w/ DAS; sometimes refers specifically to a sub-component of the DAS such as the main computer running the DAQ software (or the DAQ software itself, for that matter)
DAS: Data Acquisition System; the holistic system for collecting (recording) measurement data, e.g., in the field
DHI: Diffuse horizontal irradiance [W/m^2]
DNI: Direct normal irradiance [W/m^2]
GHI: Global horizontal irradiance [W/m^2]
Gpoa: Global plane-of-array irradiance [W/m^2]
Gpoa_Ref: Global plane-of-array irradiance at reference conditions [W/m^2]
Gpoa_Sref: Self-reference irradiance derived from a PV device's Isc [W/m^2]
IEC 60904-3 AM1.5G: Standard global (G) solar spectrum historically associated w/ air mass AM ratio 1.5 (air mass is a geometrical calculation, whereas spectrum is W/m^2/lambda, where lambda is the wavelength of light, in nm) (synonyms of spectrum: spectral irradiance, spectral irradiance distribution, & spectrally-resolved irradiance)
Isc: Short-circuit current [Amps, or A]
IscLin: Deviation from Isc linearity (when assuming a unity 1:1 relationship b/w Isc & irradiance, which applies to so-called "linear" PV devices)
IscNorm_Ref: Isc normalized to reference conditions of spectrum, irradiance, & temperature (e.g., STC)
Pmp: Maximum power (e.g., power at max. power point MPP on I-V curve)
PmpDC: DC power [W]
PmpDC_Ref: DC power at reference conditions [Watts, or W]
PTC: PVUSA Test Conditions (more field-representative test conditions than STC, esp. for the Northern California region encompassing the PVUSA field testing site in Davis, CA; Gpoa=1,000 W/m^2, Tamb=20 degC, & Wspd=1 m/s; namely, Tmod is not close to the STC case of 25 degC in the field, so it does not work well to extrapolate the data to STC)
PV: Photovoltaic (often used as adjective adj.; noun is often the plural form photovoltaics)
RC: Reporting Condition (e.g., RCs are often STC for indoor performance evaluation in a laboratory with a flash tester and PTC for outdoor field performance evaluation in the installed, field-operating condition)
RI: Reporting Interval (e.g., data is collected in the field & rolled into, e.g., 5-min averages; in this case, the RI is 5-min; note that data collection using DAS aka DAQ)
RP: Reporting Period (e.g., 5-min RI data is evaluated each month for ASTM E2848 Power Capacity; in this case, the RP is monthly)
STC: Standard Test Conditions (Gpoa=1,000 W/m^2, Tcell=25 degC, spectrum=IEC 60904-3 AM1.5G)
Tamb: Ambient temperature [degC]
thetaZ: Angle of incidence of DNI beam [degrees or radians, depending on which convention you're working with--see more below]
Wspd: Wind speed [m/s]

## Equations in MATLAB Syntax
GHI = DHI + DNI.*cos(thetaZ);
Mind your degrees & radians (cosd's get degrees)!

## ASTM E2848 PVUSA Regression
Pmp = Gpoa*(a+b*Gpoa+c*Tamb+d*Wspd)
Supply Gpoa, Tamb, Wspd, & Pmp.
Solve for (a,b,c,d) via multiple linear (multi-linear) regression w/ no (zero) y-intercept, i.e., force y-intercept equal to 0 (Excel can do it, too, if it can hold all your field data, w/ the Analysis ToolPak add-in under File > Options > Add-Ins; see more about Excel limits in Getting Started\Excel).
(In MATLAB, Octave, & prob. Julia, it's as simple as coeffs=X\y.)
Plug in PTC conditions + (a,b,c,d) to get Pmp at PTC.
Credit & thanks to J. Newmiller, T. Townsend, C. Whitaker, & other involved members of the OG Endecon Engineering & PVUSA teams
You can also derive custom reporting conditions for each reporting period RP following ASTM E2939 (instead of plugging in fixed PTC conditions regardless of time of year).

## Fill Factor
FF = (Imp*Vmp)/(Isc*Voc);

## Efficiency
Eta = (Pmp/(height*width))./Gpoa
e.g., Height & width of PV module or system

## Self-reference Irradiance
Gpoa_Sref = Gpoa_Ref*(Isc/Isc_Ref)

## Deviation in Efficiency Relative to Efficiency at Reference Conditions
devEtaRel_Ref = [(Pmp/Pmp_Ref).*(Gpoa_Ref./Gpoa)] - 1;
e.g., Use self-reference Gpoa for so-called "linear" devices so long as deviations from Isc linearity are, e.g., <0.5% (certainly <1%).

## Rules-of-thumb
Ensure that deviations from Isc linearity IscLin are, e.g., <0.5% (certainly <1%).
IscNorm_Ref = Isc.*(Gpoa_Ref./Gpoa);
IscLin = 100*[(IscNorm_Ref/Isc_Ref) - 1];
If deviations, exceed this, troubleshoot the test system (which incl. not just the measurement apparatus & models used; also, the human operators, technicians, engineers involved in the measurement design & in the taking of the actual measurements themselves).

## Quick-n-dirty Power Normalization
Pmp = PmpRef*[1-gPmp.*(Tcell-Tcell_Ref)].*(Gpoa/Gpoa_Ref)
Only starts working well for >600 W/m^2 w/ Ref of 1,000 W/m^2
(In general, best to avoid irradiance & temperature extrapolations & derive reporting conditions based on the predicted or actual, measured weather that occurred & then use data w/in 20% of that so you're only interpolating).

## PVsyst Module Quality Loss Factor MQF
Negative adjustment factor AF as loss convention:
af1 [%]
af2 [%]
...
afN [%]
Negative AF as gain convention:
MQF = -1*(1-((1-af1)*(1-af2)*...*(1-afN)))
MQF = -1*(af1+af2+...+afN)

## Quick-n-dirty Series Resistance Approximation
Rs_PVsyst = (Voc-Vmp)/Imp

## Quick-n-dirty Shunt Resistance Approximation
Rsh_PVsyst = 5*Vmp/(Isc-Imp)

## Impacts of Resistances
Rs -> No impact on Voc
Rsh -> No impact on Isc (but quickly changes with >0 V)

## Electroluminescence (EL) and Infrared (IR) Imagery
See Getting Started w/ ImageJ.

## References

### Equations for PV Modeling
See https://pvpmc.sandia.gov/

## Sauer #1 Rule of Data Filtration of Time Series Data
1. If NaN in any row, remove row
2. Apply this rule after every data filtration (removal) step

## Sauer Two Lines Filter
1. Plot Power Pmp vs. Global Plane-of-array Irradiance Gpoa (Pmp vs. Gpoa)
2. Draw two diagonal lines around data cloud
y = m*x + b
3. Remove any data outside of these lines
4. Now see above Sauer #1 rule of data filtration

## PV Thermal Model (e.g., PVsyst)
U = Uc + Uv*v
1. Uc [W/m^2/degC]
2. Uv [W/m^2/degC/m/s]

## Liquidated Damages LDs - Power Capacity Test
LDs ($) based on (Pmp_Mes_W/Pmp_Mod_W)*Pmp_NP_Contract (W)*System_Price($/W), or
LDs ($) based on (Pmp_Mes_W/Pmp_Mod_W)*System_Price($)
Subtract these from the 100% nameplate NP case, i.e., (Pmp_Mes_W/Pmp_Mod_W)=1

## Clearness Index CI
Clearness index is the ratio of GHI to extraterrestrial irradiance on the plane parallel to the ground, i.e.,
clearness_index = GHI / (GHI_ET * cosd(zenith))
More specifically, the argument min_cos_zenith is present to prevent dividing by 0:
clearness_index = GHI / (GHI_ET * max(cosd(zenith), min_cos_zenith))
Source: Sandia PVLIB

## Capacity Factor CF
Capacity Factor = The energy generated by the power plant during the year divided by the energy it could have generated if it had run at its full capacity throughout the entire year (8,760 hours)
e.g.,
Last year Nellis Air Force Base produced 31,467,000 kWh/yr. The system has a nameplate DC capacity of 14.2MW. Using a 22.4% derate factor as an example, the system has a nameplate AC capacity of 11.0MW.
Capacity Factor = (31,467 MWh/yr) / (11.0MWac * 8,760 hrs/yr) * 100 = 32.7%
Source: GreenVolts, Inc.â€™s Comments on the Draft Staff Report Entitled "Comparative Costs of California Central Station Electricity Generation." (Aug. 31, 2009) (https://efiling.energy.ca.gov/GetDocument.aspx?tn=53078&DocumentContentId=8967/)
See more: https://groups.google.com/g/pvlib-python/c/byjI6aAskDI/m/jgh_JXpdAAAJ?utm_medium=email&utm_source=footer&pli=1/